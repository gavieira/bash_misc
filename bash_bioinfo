#Counts number of reads from fastq files
function readcount() {
	if [ $# -eq 0 ]; then
		echo "usage: readcount reads.fastq"
	else	
		for i in "$@"; do
			readnumber=$(wc -l "$i" | awk '{print $1"/4"}' | bc)
			file=$(wc -l "$i" | awk '{print $2}')
			echo -e $file'\t'$readnumber "reads"
		done
	fi
}

#Removes 'score' lines from seqin files
function remove_score_seqin {
	if [ $# -eq 0 ]; then
		echo "usage: remove_score_seqin annotation.seqin"
	else
		IFS=''
		while read line; do 
			if [[ '$line' =~ '^\s*score' ]]; then
				continue
			else
				echo $line
			fi
		done < $1
	fi
}

#Length of individual sequences in a multifasta file
multifasta_seqlen() {
	if [ $# -eq 0 ]; then
		echo "usage: multifasta_seqlen sequences.fasta"
	else	
		while read line; do
			if [[ "${line[0]}" =~ ">" ]] ; then
				echo -e $header"\t\t"$length
				length=0
				header=$line
				continue
			else
				let length=$((length+${#line}))
			fi
		done < $1
	fi
	echo -e $header"\t\t"$length
	unset header && unset length
}

#Sorts sequences from multifasta in increasing order of length
function multifasta_seqlen_increase {
	if [ $# -eq 0 ]; then
		echo "usage: multifasta_seqlen_increase sequences.fasta"
	else
		local increase=$(multifasta_seqlen $1 | sort -k3 -t $'\t')
		echo "$increase"
		#unset increase
	fi
}

#Sorts sequences from multifasta in decreasing order of length
function multifasta_seqlen_decrease {
	if [ $# -eq 0 ]; then
		echo "usage: multifasta_seqlen_decrease sequences.fasta"
	else
		local decrease=$(multifasta_seqlen $1 | sort -r -k3 -t $'\t')
		echo "$decrease"
		#unset decrease
	fi
}

#SRA files can be converted to fastq. Hence, when working with public data, keeping only the SRA files (generally smaller than fastq) can save up a significant ammount of hard disk space.
#So, this function recursively deletes all fastq files from a directory.
function remove_fastq {
	fastq=$(find . -name "*fastq" -type f);
	echo "These are the fastq files in this folder (including subdirectories)"$'\n' 
	for i in $fastq; do ls -lh $i; done
	read -p $'\n'"How do you want to delete these files? 1-All at once; 2-One at a time; 3-No deleting today, thanks. "  answer
	if [ $answer == "1" ]; then
		for i in $fastq; do rm $i; done
		echo "All fastq files deleted"
	elif [ $answer == "2" ]; then
		for i in $fastq; do rm -i $i; done
	else
		echo "No fastq files deleted"
	fi
	unset fastq
}

#Get the size of a directory and its primary subdirectories (default)
#Can get the size of directories in different depths, depending on the numerical argument given:
#"directory_size 0" will give the size of the current directory
#"directory_size 2" will give the size of the current directory, its primary subdirectories, and the directories inside these subdirectories.
function directory_size {
	local re='^[0-9]+$'
	if [[ "$1" =~ $re ]]; then
		du -h --max-depth=$1
	else
		du -h --max-depth=1
	fi
}
